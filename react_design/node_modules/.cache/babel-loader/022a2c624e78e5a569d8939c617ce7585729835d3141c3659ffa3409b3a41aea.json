{"ast":null,"code":"/**\r\n * @fileOverview\r\n * @author Brandon Alexander - baalexander@gmail.com\r\n */\n\nvar ServiceResponse = require('./ServiceResponse');\nvar ServiceRequest = require('./ServiceRequest');\nvar EventEmitter2 = require('eventemitter2').EventEmitter2;\n\n/**\r\n * A ROS service client.\r\n *\r\n * @constructor\r\n * @param {Object} options\r\n * @param {Ros} options.ros - The ROSLIB.Ros connection handle.\r\n * @param {string} options.name - The service name, like '/add_two_ints'.\r\n * @param {string} options.serviceType - The service type, like 'rospy_tutorials/AddTwoInts'.\r\n */\nfunction Service(options) {\n  options = options || {};\n  this.ros = options.ros;\n  this.name = options.name;\n  this.serviceType = options.serviceType;\n  this.isAdvertised = false;\n  this._serviceCallback = null;\n}\nService.prototype.__proto__ = EventEmitter2.prototype;\n/**\r\n * Call the service. Returns the service response in the\r\n * callback. Does nothing if this service is currently advertised.\r\n *\r\n * @param {ServiceRequest} request - The ROSLIB.ServiceRequest to send.\r\n * @param {function} callback - Function with the following params:\r\n * @param {Object} callback.response - The response from the service request.\r\n * @param {function} [failedCallback] - The callback function when the service call failed with params:\r\n * @param {string} failedCallback.error - The error message reported by ROS.\r\n */\nService.prototype.callService = function (request, callback, failedCallback) {\n  if (this.isAdvertised) {\n    return;\n  }\n  var serviceCallId = 'call_service:' + this.name + ':' + ++this.ros.idCounter;\n  if (callback || failedCallback) {\n    this.ros.once(serviceCallId, function (message) {\n      if (message.result !== undefined && message.result === false) {\n        if (typeof failedCallback === 'function') {\n          failedCallback(message.values);\n        }\n      } else if (typeof callback === 'function') {\n        callback(new ServiceResponse(message.values));\n      }\n    });\n  }\n  var call = {\n    op: 'call_service',\n    id: serviceCallId,\n    service: this.name,\n    type: this.serviceType,\n    args: request\n  };\n  this.ros.callOnConnection(call);\n};\n\n/**\r\n * Advertise the service. This turns the Service object from a client\r\n * into a server. The callback will be called with every request\r\n * that's made on this service.\r\n *\r\n * @param {function} callback - This works similarly to the callback for a C++ service and should take the following params:\r\n * @param {ServiceRequest} callback.request - The service request.\r\n * @param {Object} callback.response - An empty dictionary. Take care not to overwrite this. Instead, only modify the values within.\r\n *     It should return true if the service has finished successfully,\r\n *     i.e., without any fatal errors.\r\n */\nService.prototype.advertise = function (callback) {\n  if (this.isAdvertised || typeof callback !== 'function') {\n    return;\n  }\n  this._serviceCallback = callback;\n  this.ros.on(this.name, this._serviceResponse.bind(this));\n  this.ros.callOnConnection({\n    op: 'advertise_service',\n    type: this.serviceType,\n    service: this.name\n  });\n  this.isAdvertised = true;\n};\nService.prototype.unadvertise = function () {\n  if (!this.isAdvertised) {\n    return;\n  }\n  this.ros.callOnConnection({\n    op: 'unadvertise_service',\n    service: this.name\n  });\n  this.isAdvertised = false;\n};\nService.prototype._serviceResponse = function (rosbridgeRequest) {\n  var response = {};\n  var success = this._serviceCallback(rosbridgeRequest.args, response);\n  var call = {\n    op: 'service_response',\n    service: this.name,\n    values: new ServiceResponse(response),\n    result: success\n  };\n  if (rosbridgeRequest.id) {\n    call.id = rosbridgeRequest.id;\n  }\n  this.ros.callOnConnection(call);\n};\nmodule.exports = Service;","map":{"version":3,"names":["ServiceResponse","require","ServiceRequest","EventEmitter2","Service","options","ros","name","serviceType","isAdvertised","_serviceCallback","prototype","__proto__","callService","request","callback","failedCallback","serviceCallId","idCounter","once","message","result","undefined","values","call","op","id","service","type","args","callOnConnection","advertise","on","_serviceResponse","bind","unadvertise","rosbridgeRequest","response","success","module","exports"],"sources":["C:/git/Ui_design/react_design/node_modules/roslib/src/core/Service.js"],"sourcesContent":["/**\r\n * @fileOverview\r\n * @author Brandon Alexander - baalexander@gmail.com\r\n */\r\n\r\nvar ServiceResponse = require('./ServiceResponse');\r\nvar ServiceRequest = require('./ServiceRequest');\r\nvar EventEmitter2 = require('eventemitter2').EventEmitter2;\r\n\r\n/**\r\n * A ROS service client.\r\n *\r\n * @constructor\r\n * @param {Object} options\r\n * @param {Ros} options.ros - The ROSLIB.Ros connection handle.\r\n * @param {string} options.name - The service name, like '/add_two_ints'.\r\n * @param {string} options.serviceType - The service type, like 'rospy_tutorials/AddTwoInts'.\r\n */\r\nfunction Service(options) {\r\n  options = options || {};\r\n  this.ros = options.ros;\r\n  this.name = options.name;\r\n  this.serviceType = options.serviceType;\r\n  this.isAdvertised = false;\r\n\r\n  this._serviceCallback = null;\r\n}\r\nService.prototype.__proto__ = EventEmitter2.prototype;\r\n/**\r\n * Call the service. Returns the service response in the\r\n * callback. Does nothing if this service is currently advertised.\r\n *\r\n * @param {ServiceRequest} request - The ROSLIB.ServiceRequest to send.\r\n * @param {function} callback - Function with the following params:\r\n * @param {Object} callback.response - The response from the service request.\r\n * @param {function} [failedCallback] - The callback function when the service call failed with params:\r\n * @param {string} failedCallback.error - The error message reported by ROS.\r\n */\r\nService.prototype.callService = function(request, callback, failedCallback) {\r\n  if (this.isAdvertised) {\r\n    return;\r\n  }\r\n\r\n  var serviceCallId = 'call_service:' + this.name + ':' + (++this.ros.idCounter);\r\n\r\n  if (callback || failedCallback) {\r\n    this.ros.once(serviceCallId, function(message) {\r\n      if (message.result !== undefined && message.result === false) {\r\n        if (typeof failedCallback === 'function') {\r\n          failedCallback(message.values);\r\n        }\r\n      } else if (typeof callback === 'function') {\r\n        callback(new ServiceResponse(message.values));\r\n      }\r\n    });\r\n  }\r\n\r\n  var call = {\r\n    op : 'call_service',\r\n    id : serviceCallId,\r\n    service : this.name,\r\n    type: this.serviceType,\r\n    args : request\r\n  };\r\n  this.ros.callOnConnection(call);\r\n};\r\n\r\n/**\r\n * Advertise the service. This turns the Service object from a client\r\n * into a server. The callback will be called with every request\r\n * that's made on this service.\r\n *\r\n * @param {function} callback - This works similarly to the callback for a C++ service and should take the following params:\r\n * @param {ServiceRequest} callback.request - The service request.\r\n * @param {Object} callback.response - An empty dictionary. Take care not to overwrite this. Instead, only modify the values within.\r\n *     It should return true if the service has finished successfully,\r\n *     i.e., without any fatal errors.\r\n */\r\nService.prototype.advertise = function(callback) {\r\n  if (this.isAdvertised || typeof callback !== 'function') {\r\n    return;\r\n  }\r\n\r\n  this._serviceCallback = callback;\r\n  this.ros.on(this.name, this._serviceResponse.bind(this));\r\n  this.ros.callOnConnection({\r\n    op: 'advertise_service',\r\n    type: this.serviceType,\r\n    service: this.name\r\n  });\r\n  this.isAdvertised = true;\r\n};\r\n\r\nService.prototype.unadvertise = function() {\r\n  if (!this.isAdvertised) {\r\n    return;\r\n  }\r\n  this.ros.callOnConnection({\r\n    op: 'unadvertise_service',\r\n    service: this.name\r\n  });\r\n  this.isAdvertised = false;\r\n};\r\n\r\nService.prototype._serviceResponse = function(rosbridgeRequest) {\r\n  var response = {};\r\n  var success = this._serviceCallback(rosbridgeRequest.args, response);\r\n\r\n  var call = {\r\n    op: 'service_response',\r\n    service: this.name,\r\n    values: new ServiceResponse(response),\r\n    result: success\r\n  };\r\n\r\n  if (rosbridgeRequest.id) {\r\n    call.id = rosbridgeRequest.id;\r\n  }\r\n\r\n  this.ros.callOnConnection(call);\r\n};\r\n\r\nmodule.exports = Service;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}